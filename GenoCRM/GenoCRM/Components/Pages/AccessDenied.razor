@page "/access-denied"
@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization
@inject IStringLocalizer<GenoCRM.SharedResource> SharedLocalizer

<PageTitle>@SharedLocalizer["AccessDenied"]</PageTitle>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="alert alert-danger text-center">
                <h3>@SharedLocalizer["AccessDenied"]</h3>
                <p>@SharedLocalizer["NoPermissionToAccess"]</p>
                
                <AuthorizeView>
                    <Authorized>
                        <p class="text-muted">
                            @SharedLocalizer["LoggedInAs"]: <strong>
                                @{
                                    var claimsPrincipal = context.User;
                                }
                                @claimsPrincipal.FindFirst(ClaimTypes.GivenName)?.Value @claimsPrincipal.FindFirst(ClaimTypes.Surname)?.Value</strong>
                        </p>
                        <p class="text-muted">
                            @SharedLocalizer["YourGroups"]: @string.Join(", ", claimsPrincipal.FindAll("group").Select(c => c.Value))
                        </p>
                    </Authorized>
                </AuthorizeView>
                
                <div class="mt-3">
                    <a href="/" class="btn btn-primary me-2">@SharedLocalizer["GoHome"]</a>
                    <a href="/login" class="btn btn-outline-secondary">@SharedLocalizer["Login"]</a>
                </div>
            </div>
        </div>
    </div>
</div>